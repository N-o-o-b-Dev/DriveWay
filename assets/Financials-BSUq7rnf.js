import{c as S,u as I,a as N,j as e,I as L,B as p}from"./index-gxGV3Q_W.js";import{C as x,a as y,b as g,c as w}from"./Card-CzXmBwuc.js";import{T as A,a as M,b,c,d as E,e as r}from"./Table-D6RVhYMa.js";import{A as P}from"./arrow-up-right-DsOB766c.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=[["path",{d:"M17 7 7 17",key:"15tmo1"}],["path",{d:"M17 17H7V7",key:"1org7z"}]],R=S("arrow-down-left",F);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],H=S("search",z);function W(){const{transactions:C,cars:u,customers:v,dealers:D,maintenanceRecords:h}=I(),[d,$]=N.useState(""),[n,f]=N.useState("All"),o=N.useMemo(()=>{const t=[];return C.forEach(s=>{const a=u.find(l=>l.id===s.carId),i=v.find(l=>l.id===s.customerId),m=D.find(l=>l.id===s.dealerId);s.payments&&s.payments.length>0&&s.payments.forEach(l=>{t.push({...l,transactionId:s.id,carModel:a?`${a.make} ${a.model}`:"Unknown Car",customerName:i?i.name:"Unknown Customer",dealerName:m?m.name:null,rentalDate:`${s.startDate} - ${s.endDate}`,category:"Rental"})})}),h&&h.forEach(s=>{let a=0;if(s.amountPaid!==void 0&&s.amountPaid!==null&&s.amountPaid!==""?a=parseFloat(s.amountPaid):(s.paymentStatus==="Paid"||!s.paymentStatus)&&(a=parseFloat(s.amount)),a>0){const i=u.find(m=>m.id===s.carId);t.push({id:s.id,date:s.date,amount:a,type:"Debit",medium:"Cash",carModel:i?`${i.make} ${i.model}`:"Unknown Car",customerName:s.workshopName||"Workshop",dealerName:null,notes:`Maintenance: ${s.description||"No description"} (${s.workshopDetails||""})`,category:"Maintenance"})}}),t.sort((s,a)=>new Date(a.date)-new Date(s.date))},[C,u,v,D,h]).filter(t=>{const s=t.customerName.toLowerCase().includes(d.toLowerCase())||t.carModel.toLowerCase().includes(d.toLowerCase())||t.notes&&t.notes.toLowerCase().includes(d.toLowerCase()),a=n==="All"||t.type===n;return s&&a}),k=o.filter(t=>t.type==="Credit").reduce((t,s)=>t+(Number(s.amount)||0),0),T=o.filter(t=>t.type==="Debit").reduce((t,s)=>t+(Number(s.amount)||0),0),j=k-T;return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Financials"}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(x,{children:[e.jsxs(y,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(g,{className:"text-sm font-medium",children:"Net Cashflow"}),e.jsx("span",{className:"text-muted-foreground font-bold text-lg",children:"₹"})]}),e.jsx(w,{children:e.jsxs("div",{className:`text-2xl font-bold ${j>=0?"text-green-600":"text-destructive"}`,children:[j>=0?"+":"","₹",j.toLocaleString()]})})]}),e.jsxs(x,{children:[e.jsxs(y,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(g,{className:"text-sm font-medium",children:"Total Income (Credit)"}),e.jsx(R,{className:"h-4 w-4 text-green-600"})]}),e.jsx(w,{children:e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["₹",k.toLocaleString()]})})]}),e.jsxs(x,{children:[e.jsxs(y,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(g,{className:"text-sm font-medium",children:"Total Expenses (Debit)"}),e.jsx(P,{className:"h-4 w-4 text-destructive"})]}),e.jsx(w,{children:e.jsxs("div",{className:"text-2xl font-bold text-destructive",children:["₹",T.toLocaleString()]})})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 justify-between items-center",children:[e.jsxs("div",{className:"relative w-full md:w-96",children:[e.jsx(H,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(L,{placeholder:"Search customer, car, or notes...",className:"pl-8",value:d,onChange:t=>$(t.target.value)})]}),e.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[e.jsx(p,{variant:n==="All"?"default":"outline",onClick:()=>f("All"),size:"sm",children:"All"}),e.jsx(p,{variant:n==="Credit"?"default":"outline",onClick:()=>f("Credit"),size:"sm",className:n==="Credit"?"bg-green-600 hover:bg-green-700":"",children:"Income Only"}),e.jsx(p,{variant:n==="Debit"?"default":"outline",onClick:()=>f("Debit"),size:"sm",className:n==="Debit"?"bg-destructive hover:bg-destructive/90":"",children:"Expense Only"})]})]}),e.jsx(x,{children:e.jsx("div",{className:"rounded-md border",children:e.jsxs(A,{children:[e.jsx(M,{children:e.jsxs(b,{children:[e.jsx(c,{children:"Date"}),e.jsx(c,{children:"Type"}),e.jsx(c,{children:"Entity"}),e.jsx(c,{children:"Details"}),e.jsx(c,{children:"Medium"}),e.jsx(c,{className:"text-right",children:"Amount"})]})}),e.jsxs(E,{children:[o.map(t=>e.jsxs(b,{children:[e.jsx(r,{className:"font-medium whitespace-nowrap",children:t.date}),e.jsx(r,{children:e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${t.type==="Credit"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.type})}),e.jsxs(r,{children:[e.jsx("div",{className:"font-medium",children:t.customerName}),t.dealerName&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Dealer: ",t.dealerName]})]}),e.jsxs(r,{children:[e.jsx("div",{className:"text-sm",children:t.carModel}),e.jsx("div",{className:"text-xs text-muted-foreground",children:t.notes||"No notes"})]}),e.jsx(r,{className:"text-muted-foreground",children:t.medium}),e.jsxs(r,{className:`text-right font-bold ${t.type==="Credit"?"text-green-600":"text-destructive"}`,children:[t.type==="Debit"?"-":"+","₹",t.amount]})]},t.id)),o.length===0&&e.jsx(b,{children:e.jsx(r,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"No financial records found matching your filters."})})]})]})})})]})}export{W as Financials};
