import{c as f,e as p,a as c,j as e,B as o,I as j,F as N}from"./index-D4_0fjVP.js";import{C as v,c as b}from"./Card-BWG0HchX.js";import{a as w}from"./react-pdf.browser-Bx2rBD8L.js";import{I as y}from"./InvoicePDF-iUSTcXL7.js";import{A as S}from"./arrow-left-D16tWeA9.js";import{S as C}from"./search-CwyM1YDY.js";import{T as D}from"./trash-2-BHx0xHie.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],L=f("pencil",I);function P(){const n=p(),[d,m]=c.useState([]),[r,u]=c.useState("");c.useEffect(()=>{const t=localStorage.getItem("driveway_invoices");if(t)try{const s=JSON.parse(t);m(s.sort((a,i)=>i.id-a.id))}catch(s){console.error("Failed to parse invoices",s)}},[]);const g=t=>{if(confirm("Are you sure you want to delete this invoice record?")){const s=d.filter(a=>a.id!==t);m(s),localStorage.setItem("driveway_invoices",JSON.stringify(s))}},h=d.filter(t=>{var s,a,i;return((a=(s=t.customerDetails)==null?void 0:s.name)==null?void 0:a.toLowerCase().includes(r.toLowerCase()))||((i=t.invoiceNo)==null?void 0:i.toLowerCase().includes(r.toLowerCase()))});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(o,{variant:"ghost",size:"icon",onClick:()=>n("/billing"),children:e.jsx(S,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Invoice History"}),e.jsx("p",{className:"text-muted-foreground",children:"Search and manage past transactions."})]})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(C,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(j,{type:"search",placeholder:"Search by name or invoice #...",className:"pl-9",value:r,onChange:t=>u(t.target.value)})]})}),e.jsx(v,{className:"bg-background border",children:e.jsx(b,{className:"p-0",children:e.jsx("div",{className:"w-full overflow-auto",children:e.jsxs("table",{className:"w-full caption-bottom text-sm",children:[e.jsx("thead",{className:"[&_tr]:border-b",children:e.jsxs("tr",{className:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",children:[e.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium text-muted-foreground",children:"Inovice #"}),e.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium text-muted-foreground",children:"Date"}),e.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium text-muted-foreground",children:"Customer"}),e.jsx("th",{className:"h-12 px-4 text-right align-middle font-medium text-muted-foreground",children:"Details"}),e.jsx("th",{className:"h-12 px-4 text-right align-middle font-medium text-muted-foreground",children:"Total"}),e.jsx("th",{className:"h-12 px-4 text-right align-middle font-medium text-muted-foreground",children:"Actions"})]})}),e.jsx("tbody",{className:"[&_tr:last-child]:border-0",children:h.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"p-4 text-center text-muted-foreground",children:"No records found."})}):h.map(t=>{var s,a,i,x;return e.jsxs("tr",{className:"border-b transition-colors hover:bg-muted/50",children:[e.jsx("td",{className:"p-4 font-medium",children:t.invoiceNo}),e.jsx("td",{className:"p-4",children:new Date(t.date).toLocaleDateString()}),e.jsx("td",{className:"p-4",children:(s=t.customerDetails)==null?void 0:s.name}),e.jsxs("td",{className:"p-4 text-right max-w-[200px] truncate",title:(a=t.vehicles)==null?void 0:a.map(l=>l.model).join(", "),children:[(i=t.vehicles)==null?void 0:i.length," Vehicle(s)"]}),e.jsxs("td",{className:"p-4 text-right font-bold",children:["â‚¹",(x=t.grandTotal)==null?void 0:x.toLocaleString()]}),e.jsx("td",{className:"p-4 text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(o,{size:"icon",variant:"ghost",className:"h-8 w-8 text-foreground",onClick:()=>n("/billing/create",{state:{invoiceData:t}}),title:"Edit Invoice",children:e.jsx(L,{className:"h-4 w-4"})}),e.jsx(w,{document:e.jsx(y,{invoice:t}),fileName:`${t.invoiceNo}.pdf`,children:({loading:l})=>e.jsx(o,{size:"icon",variant:"ghost",className:"h-8 w-8 text-blue-600",disabled:l,title:"Download PDF",children:e.jsx(N,{className:"h-4 w-4"})})}),e.jsx(o,{size:"icon",variant:"ghost",className:"h-8 w-8 text-destructive",onClick:()=>g(t.id),title:"Delete Record",children:e.jsx(D,{className:"h-4 w-4"})})]})})]},t.id)})})]})})})})]})}export{P as BillingHistory};
