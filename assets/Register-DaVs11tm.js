import{u as M,a as n,j as e,B as S,P,I as d,S as U,k as V,l as z}from"./index-BwtqAUt7.js";import{C as G,a as J}from"./Card-aWMVJlsh.js";import{T as K,a as Q,b as x,c as o,d as W,e as l}from"./Table-D_po6nZo.js";import{A as D}from"./arrow-right-CsOetT9J.js";import{A as E}from"./arrow-left-LnmviQ8u.js";function se(){const{registers:C,cars:u,customers:b,addRegister:T,isLoading:I}=M(),[k,h]=n.useState(!1),[N,A]=n.useState(""),[p,O]=n.useState("All"),[g,R]=n.useState(""),[j,$]=n.useState(""),[a,r]=n.useState({date:new Date().toISOString().slice(0,16),type:"Entry",carId:"",name:"",notes:""}),L=s=>{s.preventDefault(),T({...a,date:new Date(a.date).toISOString()}),h(!1),r({date:new Date().toISOString().slice(0,16),type:"Entry",carId:"",name:"",notes:""})},v=C.filter(s=>{const t=u.find(m=>m.id===s.carId);let i=s.name;if(s.customerId){const m=b.find(H=>H.id===s.customerId);m&&(i=m.name)}const f=`${i||""} ${(t==null?void 0:t.make)||""} ${(t==null?void 0:t.model)||""} ${(t==null?void 0:t.plateNumber)||""} ${s.notes||""}`.toLowerCase().includes(N.toLowerCase()),F=p==="All"||s.type===p,y=new Date(s.date),q=!g||y>=new Date(g),B=!j||y<=new Date(j+"T23:59:59");return f&&F&&q&&B}),w=n.useMemo(()=>[...v].sort((s,t)=>new Date(t.date)-new Date(s.date)),[v]);return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Entry/Exit Register"}),e.jsxs(S,{onClick:()=>h(!0),children:[e.jsx(P,{className:"mr-2 h-4 w-4"})," Manual Entry"]})]}),e.jsxs("div",{className:"flex flex-col gap-4 bg-muted/40 p-4 rounded-lg border",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center w-full",children:[e.jsx("div",{className:"relative flex-1 w-full",children:e.jsx(d,{placeholder:"Search register by name, vehicle, or notes...",className:"bg-background",value:N,onChange:s=>A(s.target.value)})}),e.jsxs("select",{className:"h-10 w-full sm:w-[150px] rounded-md border border-input bg-background px-3 py-2 text-sm",value:p,onChange:s=>O(s.target.value),children:[e.jsx("option",{value:"All",children:"All Types"}),e.jsx("option",{value:"Entry",children:"Entry (In)"}),e.jsx("option",{value:"Exit",children:"Exit (Out)"})]})]}),e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground whitespace-nowrap",children:"From:"}),e.jsx(d,{type:"date",className:"bg-background w-auto",value:g,onChange:s=>R(s.target.value)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground whitespace-nowrap",children:"To:"}),e.jsx(d,{type:"date",className:"bg-background w-auto",value:j,onChange:s=>$(s.target.value)})]})]})]}),e.jsx(G,{children:e.jsx(J,{className:"p-0",children:e.jsxs(K,{children:[e.jsx(Q,{children:e.jsxs(x,{children:[e.jsx(o,{children:"Date & Time"}),e.jsx(o,{children:"Type"}),e.jsx(o,{children:"Car"}),e.jsx(o,{children:"Name"}),e.jsx(o,{children:"Notes"})]})}),e.jsx(W,{children:I?e.jsx(x,{children:e.jsx(l,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"Loading register..."})}):w.length===0?e.jsx(x,{children:e.jsx(l,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"No entries found."})}):w.map(s=>{const t=u.find(c=>c.id===s.carId);let i=s.name;if(s.customerId){const c=b.find(f=>f.id===s.customerId);c&&(i=c.name)}return e.jsxs(x,{children:[e.jsxs(l,{className:"font-medium",children:[new Date(s.date).toLocaleDateString(),e.jsx("span",{className:"text-muted-foreground ml-2 text-xs",children:new Date(s.date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),e.jsx(l,{children:e.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full px-2.5 py-0.5 text-xs font-medium ${s.type==="Entry"?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800"}`,children:[s.type==="Entry"?e.jsx(D,{className:"h-3 w-3"}):e.jsx(E,{className:"h-3 w-3"}),s.type]})}),e.jsx(l,{children:t?e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{children:[t.make," ",t.model]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:t.plateNumber})]}):e.jsx("span",{className:"text-muted-foreground italic",children:"Unknown Car"})}),e.jsx(l,{children:i||"-"}),e.jsx(l,{className:"text-muted-foreground text-sm truncate max-w-[200px]",children:s.notes})]},s.id)})})]})})}),e.jsx(U,{isOpen:k,onClose:()=>h(!1),className:"w-[400px] sm:w-[540px]",children:e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx(V,{children:e.jsx(z,{children:"Add Register Entry"})}),e.jsxs("form",{id:"add-register-form",onSubmit:L,className:"mt-6 space-y-6 flex-1 overflow-y-auto",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Type"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("button",{type:"button",onClick:()=>r({...a,type:"Entry"}),className:`flex items-center justify-center gap-2 p-3 rounded-md border text-sm font-medium transition-colors ${a.type==="Entry"?"bg-green-100 border-green-200 text-green-900":"hover:bg-muted bg-background"}`,children:[e.jsx(D,{className:"h-4 w-4"}),"Entry (In)"]}),e.jsxs("button",{type:"button",onClick:()=>r({...a,type:"Exit"}),className:`flex items-center justify-center gap-2 p-3 rounded-md border text-sm font-medium transition-colors ${a.type==="Exit"?"bg-orange-100 border-orange-200 text-orange-900":"hover:bg-muted bg-background"}`,children:[e.jsx(E,{className:"h-4 w-4"}),"Exit (Out)"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Date & Time"}),e.jsx(d,{type:"datetime-local",value:a.date,onChange:s=>r({...a,date:s.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Vehicle"}),e.jsxs("select",{className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:a.carId,onChange:s=>r({...a,carId:s.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select a vehicle..."}),u.map(s=>e.jsxs("option",{value:s.id,children:[s.make," ",s.model," (",s.plateNumber,")"]},s.id))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Name (Driver/Customer)"}),e.jsx(d,{placeholder:"Enter name",value:a.name,onChange:s=>r({...a,name:s.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Notes"}),e.jsx(d,{placeholder:"Optional notes",value:a.notes,onChange:s=>r({...a,notes:s.target.value})})]})]}),e.jsx("div",{className:"pt-4 mt-auto",children:e.jsx(S,{type:"submit",className:"w-full",children:"Add Entry"})})]})]})})]})}export{se as Register};
