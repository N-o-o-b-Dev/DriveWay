import{c as S,h as I,e as D,u as L,a as o,j as e,B as p,C as q}from"./index-CY3grNaN.js";import{C as r,a as f,b as j,c as i}from"./Card-BXQ70ezj.js";import{E}from"./EditTransactionDrawer-goZjf42a.js";import{A as T}from"./arrow-left-BSFqlO4t.js";import{M as g}from"./mail-BPgHp7Ij.js";import{P as N}from"./phone-DsX1Wd0m.js";import{S as M}from"./square-pen-DsQTHsOQ.js";import"./Table-ReX1Opzq.js";import"./react-pdf.browser-COupAn_t.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],B=S("calendar",$);function J(){const{id:d}=I(),v=D(),{transactions:b,dealers:m,customers:y,cars:w}=L(),[t,P]=o.useState(null),[x,h]=o.useState(null);if(o.useEffect(()=>{const s=m.find(a=>a.id===d);s&&P(s)},[d,m]),!t)return e.jsx("div",{className:"p-8",children:"Loading..."});const c=b.filter(s=>s.dealerId===t.id),C=c.reduce((s,a)=>s+(Number(a.total)||0),0),A=c.filter(s=>s.paymentStatus!=="Paid").reduce((s,a)=>s+Math.max(0,(Number(a.total)||0)-(Number(a.amountPaid)||0)),0),k=[...new Set(c.map(s=>s.customerId).filter(s=>s))],u=y.filter(s=>k.includes(s.id)),l=(s,a="Image Preview")=>{if(!s)return;const n=window.open("");n.document.write(`
            <html>
                <head><title>${a}</title></head>
                <body style="margin:0; display:flex; justify-content:center; align-items:center; background:#f0f0f0; height:100vh;">
                    <img src="${s}" style="max-width:100%; max-height:100vh; object-fit:contain; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);" />
                </body>
            </html>
        `),n.document.close()};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>v("/dealers"),children:e.jsx(T,{className:"h-5 w-5"})}),t.image?e.jsx("div",{className:"h-16 w-16 rounded-full overflow-hidden border-2 border-muted cursor-pointer",onClick:()=>l(t.image,"Profile Image"),children:e.jsx("img",{src:t.image,alt:t.name,className:"h-full w-full object-cover"})}):e.jsx("div",{className:"h-16 w-16 rounded-full bg-primary/10 flex items-center justify-center text-primary font-bold text-2xl",children:t.name[0]}),e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:t.name})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs(r,{children:[e.jsx(f,{children:e.jsx(j,{children:"Contact Information"})}),e.jsxs(i,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:t.email})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:t.phone})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(r,{children:e.jsxs(i,{className:"p-4 pt-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Generated"}),e.jsxs("h3",{className:"text-2xl font-bold",children:["₹",C.toLocaleString()]})]})}),e.jsx(r,{children:e.jsxs(i,{className:"p-4 pt-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pending Collection"}),e.jsxs("h3",{className:"text-2xl font-bold text-destructive",children:["₹",A.toLocaleString()]})]})})]}),e.jsxs(r,{children:[e.jsx(f,{className:"pb-3",children:e.jsx(j,{className:"text-base",children:"Business Information"})}),e.jsxs(i,{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Unique ID"}),e.jsx("span",{className:"font-medium",children:t.uniqueId||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Contact Person"}),e.jsx("span",{className:"font-medium",children:t.contactPerson||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"PAN Number"}),e.jsx("span",{className:"font-medium",children:t.pan||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Address"}),e.jsx("span",{className:"font-medium max-w-[200px] text-right",children:t.address||"N/A"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Documents"}),e.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[t.logo&&e.jsxs("div",{className:"aspect-square rounded bg-muted overflow-hidden relative group cursor-pointer",onClick:()=>l(t.logo,"Logo"),children:[e.jsx("img",{src:t.logo,alt:"Logo",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity text-white text-xs font-bold",children:"Logo"})]}),t.proof&&e.jsxs("div",{className:"aspect-square rounded bg-muted overflow-hidden relative group cursor-pointer",onClick:()=>l(t.proof,"Proof"),children:[e.jsx("img",{src:t.proof,alt:"Proof",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity text-white text-xs font-bold",children:"Proof"})]}),t.altProof&&e.jsxs("div",{className:"aspect-square rounded bg-muted overflow-hidden relative group cursor-pointer",onClick:()=>l(t.altProof,"Alt Proof"),children:[e.jsx("img",{src:t.altProof,alt:"Alt Proof",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity text-white text-xs font-bold",children:"Alt Proof"})]}),t.shopAct&&e.jsxs("div",{className:"aspect-square rounded bg-muted overflow-hidden relative group cursor-pointer",onClick:()=>l(t.shopAct,"Shop Act"),children:[e.jsx("img",{src:t.shopAct,alt:"Shop Act",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity text-white text-xs font-bold",children:"Shop Act"})]}),t.panImage&&e.jsxs("div",{className:"aspect-square rounded bg-muted overflow-hidden relative group cursor-pointer",onClick:()=>l(t.panImage,"PAN Image"),children:[e.jsx("img",{src:t.panImage,alt:"PAN",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity text-white text-xs font-bold",children:"PAN"})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-3",children:"Transaction History"}),e.jsx("div",{className:"space-y-3",children:c.length>0?c.map(s=>{const a=w.find(n=>n.id===s.carId);return e.jsx(r,{className:"overflow-hidden",children:e.jsxs(i,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:a?`${a.make} ${a.model}`:"Unknown Car"})]}),e.jsx("span",{className:`text-sm font-semibold ${s.status==="Active"?"text-green-600":"text-gray-600"}`,children:s.status})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-3",children:[e.jsx(B,{className:"h-4 w-4"}),new Date(s.startDate).toLocaleString()," - ",new Date(s.endDate).toLocaleString()]}),e.jsxs("div",{className:"flex justify-between items-center pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm font-medium",children:["₹",s.total]}),Number(s.amountPaid)>0&&s.paymentStatus!=="Paid"&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(Paid: ₹",s.amountPaid,")"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${s.paymentStatus==="Paid"?"bg-green-100 text-green-800":s.paymentStatus==="Pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:s.paymentStatus||"Pending"}),e.jsx(p,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>h(s),children:e.jsx(M,{className:"h-3 w-3"})})]})]})]})},s.id)}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No transactions found."})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-3",children:"Associated Customers"}),e.jsx("div",{className:"space-y-3",children:u.length>0?u.map(s=>e.jsx(r,{children:e.jsxs(i,{className:"p-4",children:[e.jsx("h4",{className:"font-medium mb-1",children:s.name}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx(g,{className:"mr-2 h-4 w-4"}),s.email]}),e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx(N,{className:"mr-2 h-4 w-4"}),s.phone]})]})]})},s.id)):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No associated customers."})})]})]})]}),e.jsx(E,{isOpen:!!x,onClose:()=>h(null),transaction:x})]})}export{J as DealerDetailsPage};
